## JSæ•°æ®ç±»å‹

### åŸºç¡€(åŸå§‹)ç±»å‹
> jsåŸºç¡€(åŸå§‹)ç±»å‹æœ‰å“ªå‡ ç§ï¼Ÿ

- boolean
- number
- string
- null
- undefined
- symbol

åŸºç¡€ç±»å‹å­˜å‚¨çš„æ˜¯å€¼(è€ŒéæŒ‡é’ˆå†…å­˜ç©ºé—´),æ˜¯æ²¡æœ‰å‡½æ•°å¯ä»¥è°ƒç”¨çš„
å¦‚ `1.toString()` æŠ¥é”™

---

ğŸ¤”: æœ‰æ„æ€çš„æ˜¯ `'1'.toString()`å­—ç¬¦ä¸²ç±»å‹æœ‰å‡½æ•°è°ƒç”¨,`(1).toString()`æ­£å¸¸è°ƒç”¨è¾“å‡º`'1'`

è¿™æ˜¯å› ä¸ºè°ƒç”¨çš„æ—¶å€™`'1'`å·²ç»ä¸æ˜¯åŸºç¡€ç±»å‹ï¼Œè€Œæ˜¯`Stringå¯¹è±¡ç±»å‹`ï¼Œ`(1)`åŒç†ï¼Œä¸æ˜¯æ•°å­—ç±»å‹

---

ğŸ¤”: æœ‰æ„æ€çš„æ˜¯ `typeof null --> object` , ä½†æ˜¯`null`æ˜¯**åŸºç¡€ç±»å‹è€Œéå¯¹è±¡ç±»å‹**ï¼Œè¿™æ˜¯å› ä¸º`typeof` åˆ¤æ–­ç±»å‹æ ¹æ®`000`å¼€å¤´ä»£è¡¨å¯¹è±¡, è€Œ`null`è¢«è®¾ç½®ä¸º`å…¨0`, è¿™ä¹Ÿæ˜¯JSçš„æ‚ ä¹…BUG

---

### å¯¹è±¡(å¼•ç”¨)ç±»å‹

> å¯¹è±¡ç±»å‹å’ŒåŸºç¡€(åŸå§‹)ç±»å‹çš„ä¸åŒä¹‹å¤„

åŸºç¡€ç±»å‹å­˜å‚¨çš„æ˜¯å€¼ï¼Œå¯¹è±¡ç±»å‹å­˜å‚¨çš„æ˜¯æŒ‡é’ˆ(åœ°å€)å†…å­˜ç©ºé—´

å¹¶ä¸”å¯ä»¥ `.xx` çš„å½¢å¼è°ƒç”¨å‡½æ•°

```js
const a = []
const b = a
b.push(1)
```

åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„å†…å­˜ç©ºé—´ï¼Œå¾—åˆ°æŒ‡é’ˆ `#001` èµ‹å€¼ç»™å¸¸é‡aï¼Œaèµ‹å€¼ç»™å¸¸é‡bï¼Œå³aå’Œbéƒ½æ˜¯ `#001`çš„æŒ‡é’ˆ

ä¿®æ”¹æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯aå’ŒbæŒ‡é’ˆçš„å†…å®¹éƒ½å‘ç”Ÿå˜åŒ–
è¿™ä¹Ÿæ˜¯æ·±æµ…æ‹·è´å‡ºç°çš„åŸå› 

### JSå†…å­˜ç©ºé—´

è¿™é‡Œä»æœ€ç®€å•çš„èµ‹å€¼å¼€å§‹ç†è§£
- é¦–å…ˆæµè§ˆå™¨æ‰§è¡ŒJSä»£ç ï¼Œéœ€è¦æœ‰JSæ‰§è¡Œçš„ç¯å¢ƒï¼ˆç©ºé—´ï¼‰
- å…¶æ¬¡æ˜¯æ‰§è¡ŒJSçš„äºº

ä¸ğŸ‘†å¯¹åº”çš„æ˜¯
1.Â ç¯å¢ƒï¼šä»ç”µè„‘å†…å­˜ï¼ˆè¿è¡Œå†…å­˜,ä¸€èˆ¬ä¸º8gï¼‰åˆ†é…å‡ºä¸€å—å†…å­˜ï¼Œå³ï¼Œ`æ ˆå†…å­˜Stack`
2.Â äººï¼š`æ ˆå†…å­˜`é‡Œå†åˆ†é…å‡ºä¸€ä¸ª`ä¸»æµç¨‹`ç”¨æ¥è‡ªä¸Šè€Œä¸‹æ‰§è¡ŒJS
> ps:Â `æ ˆå†…å­˜`é‡Œæœ‰`å˜é‡å­˜å‚¨ç©ºé—´`ã€`å€¼å­˜å‚¨ç©ºé—´`ã€`ä¸»çº¿ç¨‹`

ä¾‹å¦‚ï¼š
```js
letÂ aÂ =Â 1
```
åœ¨æµè§ˆå™¨æ‰§è¡Œä¼šå‘ç”Ÿ
1.Â åˆ›å»ºå˜é‡aï¼Œæ”¾åˆ°`å˜é‡å­˜å‚¨ç©ºé—´`
2.Â åˆ›å»ºä¸€ä¸ªå€¼1ï¼Œæ”¾åˆ°`å€¼å­˜å‚¨ç©ºé—´`ï¼Œï¼ˆå¼•ç”¨ç±»å‹å€¼ä¸æ˜¯ç®€å•çš„æ”¾åˆ°`å€¼å­˜å‚¨ç©ºé—´`ï¼‰
3.Â =èµ‹å€¼ï¼Œä½¿`å˜é‡å­˜å‚¨ç©ºé—´`çš„å˜é‡æŒ‡å‘ç›¸åº”çš„`å€¼å­˜å‚¨ç©ºé—´`çš„å€¼
ğŸ‘†ç®€å•æ¥è¯´
1.Â æ‰§è¡Œ `â€˜=â€˜` å·¦è¾¹
2.Â æ‰§è¡Œ `â€˜=â€˜` å³è¾¹
3.Â æ‰§è¡Œ `â€˜=â€˜` èµ‹å€¼

å¼•ç”¨ç±»å‹å€¼
å¯¹åº” ğŸ‘† ç¬¬2æ­¥åˆ›å»ºå€¼çš„æ—¶å€™ï¼Œéœ€è¦3ä¸ªæ­¥éª¤
1. åœ¨å†…å­˜ä¸­åˆ†é…å‡ºä¸€å—æ–°å†…å­˜ï¼Œå³ï¼Œ`å †å†…å­˜heap`
  - ä¸”å †å†…å­˜æœ‰ä¸ª16è¿›åˆ¶çš„åœ°å€(æŒ‡é’ˆ)ï¼Œç”¨äºç»™å˜é‡æŒ‡å‘è‡ªå·±
2. æŠŠå¼•ç”¨ç±»å‹å€¼ï¼ˆå¯¹è±¡ï¼‰ä¾æ¬¡å­˜å…¥å †å†…å­˜ä¸­(é”®å€¼å¯¹å½¢å¼)
3. æŠŠ`å€¼å­˜å‚¨ç©ºé—´`çš„å€¼åœ°å€(16è¿›åˆ¶)æŒ‡å‘ç›¸åº”çš„`å †å†…å­˜`

![](https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221201205655.png)

ğŸ‘†è¿™å°±æ˜¯æ·±æµ…æ‹·è´å‡ºç°çš„åŸå› ï¼Œå¼•ç”¨ç±»å‹å€¼ä¿®æ”¹äº†å†…å®¹
å¦ä¸€ä¸ªæŒ‡å‘å®ƒçš„å€¼ä¹Ÿè¢«æ”¹å˜äº†ï¼Œä»è€Œå¯¼è‡´bug


### ç±»å‹åˆ¤æ–­

> `typeof`é™¤äº†`null`åˆ¤æ–­ä¸å‡ºçœŸå®ç±»å‹å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆå…¶ä»–é—®é¢˜ï¼Ÿè€Œ`instanceof`åˆ¤æ–­ç±»å‹çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

```js
typeof 1 // 'number'
typeof '1' // 'string'
typeof undefined // 'undefined'
typeof true // 'boolean'
typeof Symbol() // 'symbol'

typeof [] // 'object'
typeof {} // 'object'
typeof console.log // 'function'
```
åŸºç¡€ç±»å‹ä¸­ `typeof`åªæ˜¯åˆ¤æ–­ä¸å‡º `null`
å¼•ç”¨ç±»å‹ä¸­ åªèƒ½åˆ¤æ–­å‡º `object` å’Œ `function`

TODO: 
`instanceof` åŸç†æ˜¯æ ¹æ®åŸå‹é“¾åˆ¤æ–­ç±»å‹çš„ï¼Œå› æ­¤å¯ä»¥çŸ¥é“å¼•ç”¨ç±»å‹çš„å…·ä½“ç±»å‹
```js
// æ„é€ å‡½æ•°
const Person = function() {}
const p1 = new Person()
p1 instanceof Person // true

// å­—ç¬¦ä¸²
var str1 = new String('hello world')
str1 instanceof String // true
```

`'hello world' instanceof String --> false`

åŸºç¡€ç±»å‹å¹¶ä¸èƒ½åˆ¤æ–­å‡ºæ¥ï¼ï¼ï¼

---

ğŸ¤”: åŸå‹é“¾ä¹Ÿæ˜¯å¯ä»¥ç¯¡æ”¹çš„ï¼Œå½“é€šè¿‡`[Symbolã€‚hasInstance]`ä¿®æ”¹åŸå‹é“¾ï¼Œ `instanceof` ä¹Ÿä¸æ˜¯ç™¾åˆ†ä¹‹ç™¾å¯ä¿¡, é‚£ç°åœ¨å¸¸ç”¨çš„jsåˆ¤æ–­ç±»å‹å·¥å…·æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œåˆæ˜¯å¦å¯ä¿¡å‘¢ï¼Ÿ

---

### ç±»å‹éšå¼è½¬åŒ–

#### TODO: å¯¹è±¡è½¬åŸºç¡€ç±»å‹
å¯¹è±¡åœ¨è½¬æ¢ç±»å‹çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨å†…ç½®çš„ [[ToPrimitive]] å‡½æ•°ï¼Œå¯¹äºè¯¥å‡½æ•°æ¥è¯´ï¼Œç®—æ³•é€»è¾‘ä¸€èˆ¬æ¥è¯´å¦‚ä¸‹ï¼š

- å¦‚æœå·²ç»æ˜¯åŸå§‹ç±»å‹äº†ï¼Œé‚£å°±ä¸éœ€è¦è½¬æ¢äº†
- è°ƒç”¨ x.valueOf()ï¼Œå¦‚æœè½¬æ¢ä¸ºåŸºç¡€ç±»å‹ï¼Œå°±è¿”å›è½¬æ¢çš„å€¼
- è°ƒç”¨ x.toString()ï¼Œå¦‚æœè½¬æ¢ä¸ºåŸºç¡€ç±»å‹ï¼Œå°±è¿”å›è½¬æ¢çš„å€¼
- å¦‚æœéƒ½æ²¡æœ‰è¿”å›åŸå§‹ç±»å‹ï¼Œå°±ä¼šæŠ¥é”™

å½“ç„¶ä½ ä¹Ÿå¯ä»¥é‡å†™ Symbol.toPrimitive ï¼Œè¯¥æ–¹æ³•åœ¨è½¬åŸå§‹ç±»å‹æ—¶è°ƒç”¨ä¼˜å…ˆçº§æœ€é«˜ã€‚
```js
let a = {
  valueOf() {
    return 0
  },
  toString() {
    return '1'
  },
  [Symbol.toPrimitive]() {
    return 2
  }
}
1 + a // => 3
```

#### å››åˆ™è¿ç®—å¯¼è‡´éšå¼è½¬åŒ–
- åŠ æ³•ï¼šæŠŠéæ•°å­—å­—ç¬¦ä¸²ç±»å‹ï¼Œå…ˆè½¬åŒ–ä¸ºæ•°å­—æˆ–å­—ç¬¦ä¸²ï¼Œå¦‚æœå…¶ä¸­ä¸€æ–¹æ˜¯å­—ç¬¦ä¸²å°±ä¼šæŠŠå¦ä¸€æ–¹ä¹Ÿè½¬æ¢ä¸ºå­—ç¬¦ä¸²
  - `true + true --> 2` å…ˆè½¬åŒ–ä¸ºæ•°å­—ï¼Œå†ç›¸åŠ ï¼Œä¸”æ²¡æœ‰å­—ç¬¦ä¸²ç»“æœä¸ºæ•°å­—2
  - `4+[1,2,3] --> '41,2,3'` æ•°ç»„å…ˆ`toString`è½¬åŒ–ä¸ºå­—ç¬¦ä¸²`'1,2,3'`,å…¶ä¸­ä¸€æ–¹æ˜¯å­—ç¬¦ä¸²ï¼Œå› æ­¤å¦ä¸€æ–¹æ•°å­—4è½¬åŒ–ä¸ºå­—ç¬¦ä¸²åç›¸åŠ 
  - `'a' + + 'b' --> 'aNaN'` å…ˆè®¡ç®—åé¢(TODO: why?)çš„` + 'b' --> NaN` ç±»ä¼¼äº `+'1'`å¯ä»¥è½¬åŒ–å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆ`'a' + NaN --> 'aNaN'`
- å‡ä¹˜é™¤ï¼Œä¸€æ–¹æ˜¯æ•°å­—ï¼Œå¦ä¸€æ–¹å°±ä¼šè¢«è½¬ä¸ºæ•°å­—
  - `4*[] --> 0` `4*[1,2]-->NaN`

#### æ¯”è¾ƒè¿ç®—å¯¼è‡´éšå¼è½¬åŒ–
- å¯¹è±¡ç±»å‹ é€šè¿‡ `toPrimitive` è½¬æ¢å¯¹è±¡(TODO: what?)ï¼Œé€šè¿‡ `valueOf` è½¬æ¢ä¸ºåŸå§‹ç±»å‹å†æ¯”è¾ƒå€¼
  - `a > -1 --> true` è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¦†ç›–aå¯¹è±¡çš„`valueOf`å‡½æ•° `a = { valueOf(){return -2} }`ï¼Œå°±å¯ä»¥å½±å“åˆ°å¯¹è±¡æ¯”è¾ƒç»“æœ
- å­—ç¬¦ä¸²ç±»å‹ é€šè¿‡ `unicode` å­—ç¬¦ç´¢å¼•æ¯”è¾ƒ

#### éå…¨ç­‰åˆ¤æ–­è¯­å¥å¯¼è‡´éšå¼è½¬åŒ–

![](https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221130150234.png)

---

ğŸ¤”: `[] == ![]` çš„è½¬åŒ–è¿‡ç¨‹ TODO:

```
[] == ![]
[] == false
[] == ToNumber(false)
[] == 0
ToPrimitive([]) == 0
'' == 0
0 == 0 // -> true
```

```js
let obj = {
  [Symbol.toPrimitive](hint) {
    switch (hint) {
      case 'number':
        return 123;
      case 'string':
        return 'str';
      case 'default':
        return 'default';
      default:
        throw new Error();
     }
   }
};

// [é˜²çˆ¬è™«æ ‡è¯†-æ²™æµ·å¬é›¨]

2 * obj // 246
3 + obj // '3default'
obj == 'default' // true
String(obj) // 'str'
```
---

#### JS ä¸­ç±»å‹è½¬æ¢åªæœ‰ä¸‰ç§æƒ…å†µ

- å„ç§ç±»å‹è½¬æ¢ä¸ºå¸ƒå°”å€¼
  -  `undefined` `null` `false` `NaN` `''` `0` `-0` è½¬ä¸º `false`
  - å…¶ä»–æ‰€æœ‰å€¼éƒ½è½¬ä¸º `true` ï¼ŒåŒ…æ‹¬æ‰€æœ‰å¯¹è±¡
- å„ç§ç±»å‹è½¬æ¢ä¸ºæ•°å­—
- å„ç§ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²

![](https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221130095726.png)
ğŸ‘† å¯¹åº”å„ç§ç±»å‹è½¬åŒ–ä¸ºå¸ƒå°”ã€å­—ç¬¦ä¸²ã€æ•°å­—çš„ç»“æœ


### TODO: ä½œä¸ºå°å†Œï¼Œå¹¶ä¸è¯¦ç»†ï¼Œè¯¦ç»†çŸ¥è¯†åç»­è¡¥å……ï¼
