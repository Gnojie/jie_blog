## é¢è¯•ä¸­é—®çš„thisæŒ‡å‘

### æ™®é€šå‡½æ•°3ç§è°ƒç”¨æ–¹å¼

```js
var a = 1

function foo() {
  console.log(this.a)
}

const obj = {
  a: 2,
  foo: foo
}

foo() // 1. ç›´æ¥è°ƒç”¨
obj.foo() // 2. å¯¹è±¡è°ƒç”¨
const c = new foo() // 3. å®ä¾‹åŒ–è°ƒç”¨
```

- ç›´æ¥è°ƒç”¨ï¼Œä¸ç®¡ `foo` å‡½æ•°è¢«æ”¾åœ¨äº†ä»€ä¹ˆåœ°æ–¹ï¼Œ`this` ä¸€å®šæ˜¯ `window`
- `obj.`è°ƒç”¨`foo()`ï¼Œæˆ‘ä»¬åªéœ€è¦è®°ä½ï¼Œè°è°ƒç”¨äº†å‡½æ•°ï¼Œè°å°±æ˜¯ `this`ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ `foo` å‡½æ•°ä¸­çš„ `this` å°±æ˜¯ `obj` å¯¹è±¡
- `new` çš„æ–¹å¼æ¥è¯´ï¼Œ`this` è¢«æ°¸è¿œç»‘å®šåœ¨äº† `c` ä¸Šé¢ï¼Œä¸ä¼šè¢«ä»»ä½•æ–¹å¼æ”¹å˜ `this`

### ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°å…¶å®æ˜¯æ²¡æœ‰ `this` çš„
ç®­å¤´å‡½æ•°ä¸­çš„ `this` åªå–å†³åŒ…è£¹ç®­å¤´å‡½æ•°çš„ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°

```js
function a() {
  return () => {
    return () => {
      console.log(this)
    }
  }
}
console.log(a()()()) // window
```
ğŸ‘† å› ä¸ºåŒ…è£¹ç®­å¤´å‡½æ•°çš„ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°æ˜¯ `a`ï¼Œæ‰€ä»¥æ­¤æ—¶çš„ `this` ä¸æ˜¯aè€Œæ˜¯ `window`

å¦å¤–å¯¹ç®­å¤´å‡½æ•°ä½¿ç”¨ bind è¿™ç±»å‡½æ•°æ˜¯æ— æ•ˆçš„ã€‚

### äººä¸ºä¿®æ”¹this

> [æ‰‹å†™call/bind](../%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97/æ‰‹å†™ç³»åˆ—-callbind.md)

---

ğŸ¤”: æœ‰æ„æ€çš„æ˜¯ `fn.bind().bind(a)() // => ?` æ­¤æ—¶çš„æ˜¯`this` æ˜¯å‰é¢ç©ºçš„ `window` ï¼Œè¿˜æ˜¯åé¢é‡ç½®çš„`a`ï¼Ÿ

ç­”æ¡ˆæ˜¯ `window`

```js
fn.bind().bind(a)

// ç­‰äº

let fn2 = function fn1() {
  return function() {
    return fn.apply()
  }.apply(a)
}
fn2()
```
ğŸ‘† ä¸ç®¡æˆ‘ä»¬ç»™å‡½æ•° `bind` å‡ æ¬¡ï¼Œ`fn` ä¸­çš„ `this` æ°¸è¿œç”±ç¬¬ä¸€æ¬¡ `bind` å†³å®šï¼Œæ‰€ä»¥ç»“æœæ°¸è¿œæ˜¯ `window`

---

### ä¼˜å…ˆçº§

- `new` çš„æ–¹å¼ä¼˜å…ˆçº§æœ€é«˜
- `bind` è¿™äº›å‡½æ•°
- `obj.foo()` è¿™ç§è°ƒç”¨æ–¹å¼
- `foo` ç›´æ¥è°ƒç”¨æ–¹å¼
- åŒæ—¶ï¼Œç®­å¤´å‡½æ•°çš„ `this` ä¸€æ—¦è¢«ç»‘å®šï¼Œå°±ä¸ä¼šå†è¢«ä»»ä½•æ–¹å¼æ‰€æ”¹å˜


### æ€»ç»“

![](https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20221130135035.png)