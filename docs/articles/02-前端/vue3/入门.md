![](https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20220711140909.png)

ğŸ‘† vue3æ–°ç‰¹æ€§å¯¹æ™®é€šå¼€å‘è€…ã€äºŒæ¬¡å¼€å‘è€…(è·¨æ®µ)ã€æºç ç»´æŠ¤è€…å¸¦æ¥çš„å¥½å¤„


```js
// åœ¨vueå®ä¾‹ä¸ŠæŒ‚è½½å…¨å±€ç»„ä»¶
Vue.component('el-counter', {
  data(){
    return {count: 1}
  },
  template: '<button @click="count++">Clicked {{ count }} times.</button>'
})

// å¼•å…¥vue-router
let VueRouter = require('vue-router')
// åœ¨vueå®ä¾‹ä¸Šé€šè¿‡useå…¨å±€æŒ‚è½½routeræ’ä»¶
Vue.use(VueRouter)
```

ä½†æ˜¯ç”±äºå…¨å±€çš„ Vue åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡µé¢çš„å¤šä¸ªåº”ç”¨ä¸­ç‹¬ç«‹ä½¿ç”¨ Vue å°±ä¼šéå¸¸å›°éš¾ã€‚
ï¼ˆåŸºæœ¬ä¸ä¼šæœ‰ã€‚ã€‚ã€‚
```js
Vue.component('el-counter',...)

new Vue({el:'#app1'})
new Vue({el:'#app2'})
```

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒVue 3 å¼•å…¥ä¸€ä¸ªæ–°çš„ API ï¼ŒcreateAppï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æ–°å¢äº† App çš„æ¦‚å¿µã€‚å…¨å±€çš„ç»„ä»¶ã€æ’ä»¶éƒ½ç‹¬ç«‹åœ°æ³¨å†Œåœ¨è¿™ä¸ª App å†…éƒ¨ï¼Œå¾ˆå¥½çš„è§£å†³äº†ä¸Šé¢æåˆ°çš„ä¸¤ä¸ªå®ä¾‹å®¹æ˜“é€ æˆæ··æ·†çš„é—®é¢˜ã€‚

```js
const { createApp } = Vue
const app = createApp({})
app.component(...)
app.use(...)
app.mount('#app1')

const app2 = createApp({})
app2.mount('#app2')
```

`createApp` è¿˜ç§»é™¤äº†å¾ˆå¤šæˆ‘ä»¬å¸¸è§çš„å†™æ³•ï¼Œæ¯”å¦‚åœ¨ `createApp` ä¸­ï¼Œå°±ä¸å†æ”¯æŒ `filterã€$onã€$offã€$setã€$delete` ç­‰ API
`slot` å’Œ `slot-scope` ä¸¤è€…å®ç°äº†åˆå¹¶ï¼Œè€Œ `directive` æ³¨å†ŒæŒ‡ä»¤çš„ API ç­‰ä¹Ÿæœ‰å˜åŒ–


@vue/compat è¿˜å¯ä»¥å¾ˆå¥½åœ°å¸®åŠ©ä½ å­¦ä¹ ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚
â€œé˜¿é‡Œå¦ˆå¦ˆâ€å‡ºå“çš„ gogocodeï¼Œé€šè¿‡ç¼–è¯‘åŸç†ï¼Œç”±vue2ä»£ç è½¬ASTï¼Œæ›¿æ¢ASTæˆvue3ï¼Œå†ç”Ÿæˆvue3ä»£ç 

viteå®˜æ–¹æ”¶é›†çš„ä¸€äº›å’Œviteç›¸å…³çš„é¡¹ç›®ï¼ŒåŒ…æ‹¬æ’ä»¶ï¼Œæ¨¡æ¿ï¼Œéƒ½åˆ†ç±»æ•´ç†å¥½çš„ï¼Œåœ°å€å¦‚ä¸‹
https://github.com/vitejs/awesome-vite

1. vuex çš„æ•°æ®æœ¬åœ°æŒä¹…åŒ–æ’ä»¶
2. æ¥å£æ•°æ®çš„mockï¼Œ json-server
3. åŸ‹ç‚¹çš„sdk
4.  @vueuse åº“ï¼Œå°è£…å¸¸ç”¨çš„hooks

é›†æˆ EditorConfig é…ç½®ï¼Œé›†æˆ husky å’Œ lint-stagedï¼Œä»£ç æäº¤æ—¶å€™æ£€æŸ¥ ESLint è§„åˆ™ï¼Œé€šè¿‡å†æäº¤


Composition API å’Œ `<script setup>`
è€Œè®©ä½ æ„Ÿåˆ°å¥½å¥‡çš„ `<script setup>` æœ¬è´¨ä¸Šæ˜¯ä»¥ä¸€ç§æ›´ç²¾ç®€çš„æ–¹å¼æ¥ä¹¦å†™ `Composition API`

å¯¹äº ref è¿”å›çš„å“åº”å¼æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ .value æ‰èƒ½ç”Ÿæ•ˆï¼Œè€Œåœ¨ `<script setup>` æ ‡ç­¾å†…å®šä¹‰çš„å˜é‡å’Œå‡½æ•°ï¼Œéƒ½å¯ä»¥åœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨

ç›´æ¥ import TodoList.vue ç»„ä»¶ï¼Œç„¶å `<script setup>` ä¼šè‡ªåŠ¨æŠŠç»„ä»¶æ³¨å†Œåˆ°å½“å‰ç»„ä»¶

æ²¡æœ‰setupçš„compositiobå†™æ³•
```js
import { ref } from "vue";
export default {
  setup() {
    let count = ref(1)
    function add() {
      count.value++
    }
    return {
      count,
      add
    }
  }
}
```

setupè¯­æ³•
```js
import { ref, computed } from "vue";

let count = ref(1)
function add(){
    count.value++
}

let { title, todos, addTodo, clear, active, all, allDone } = useTodos();
```

vue styleæ ‡ç­¾ä½¿ç”¨jsä¸­çš„å˜é‡
```html
<style scoped>
h1 { 
  color:v-bind(color);
}
</style>
```

Composition API å’Œ `<script setup>` è™½ç„¶èƒ½æé«˜å¼€å‘æ•ˆç‡ï¼Œä½†æ˜¯å¸¦æ¥çš„ä¸€äº›æ–°çš„è¯­æ³•
æ¯”å¦‚ ref è¿”å›çš„æ•°æ®å°±éœ€è¦ä¿®æ”¹ value å±æ€§
å“åº”å¼å’Œç”Ÿå‘½å‘¨æœŸä¹Ÿéœ€è¦ import åæ‰èƒ½ä½¿ç”¨ç­‰ç­‰

å¯¹äºvalueï¼Œå®˜æ–¹æ˜¯è¿™æ ·è§£é‡Šçš„ï¼š
å°†å€¼å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œçœ‹ä¼¼æ²¡æœ‰å¿…è¦
ä½†ä¸ºäº†ä¿æŒ JavaScript ä¸­ä¸åŒæ•°æ®ç±»å‹çš„è¡Œä¸ºç»Ÿä¸€ï¼Œè¿™æ˜¯å¿…é¡»çš„
è¿™æ˜¯å› ä¸ºåœ¨ JavaScript ä¸­ï¼ŒNumber æˆ– String ç­‰åŸºæœ¬ç±»å‹æ˜¯é€šè¿‡å€¼è€Œéå¼•ç”¨ä¼ é€’çš„
åœ¨ä»»ä½•å€¼å‘¨å›´éƒ½æœ‰ä¸€ä¸ªå°è£…å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ä¸­å®‰å…¨åœ°ä¼ é€’å®ƒï¼Œè€Œä¸å¿…æ‹…å¿ƒåœ¨æŸä¸ªåœ°æ–¹å¤±å»å®ƒçš„å“åº”æ€§

å…³äºå¯¼å…¥é—®é¢˜ï¼Œantfuå¤§ç¥æœ‰ä¸€ä¸ªæ’ä»¶unplugin-auto-importï¼Œå¯ä»¥è‡ªåŠ¨æ³¨å…¥ä¾èµ–é¡¹ï¼Œä¸ç”¨import

https://github.com/antfu/unplugin-auto-import

æˆ‘ä»¬å¯ä»¥åœ¨ loading çŠ¶æ€ä¸‹ï¼Œå»ä¿®æ”¹æµè§ˆå™¨çš„å°å›¾æ ‡ favicon
```js
import {ref,watch} from 'vue'
export default function useFavicon( newIcon ) {
  const favicon = ref(newIcon)

  const updateIcon = (icon) => {
    document.head
      .querySelectorAll(`link[rel*="icon"]`)
      .forEach(el => el.href = `${icon}`)
  }
  const reset = ()=>favicon.value = '/favicon.ico'

  watch( favicon,
    (i) => {
      updateIcon(i)
    }
  )
  return {favicon,reset}
} 
```

React ä¸»è¦æ„å»º App è¿˜æ˜¯ç”¨ Class Componentï¼Œå½“ç„¶ä¹Ÿæœ‰ `functional component` 
è¿™ä¿©åŒºåˆ«å°±åœ¨äº class æœ‰çŠ¶æ€ï¼Œfunctional æ¯”è¾ƒâ€œçº¯ç²¹â€æ²¡æœ‰çŠ¶æ€

ç°åœ¨ React éƒ½ç”¨ â€œfunctionalâ€ ç»„ä»¶ï¼Œä½†æ˜¯æœ‰â€œçŠ¶æ€â€çš„ï¼ŒçŠ¶æ€å“ªé‡Œæ¥çš„ â€œHookâ€ è¿‡æ¥çš„ï¼Œé’©è¿‡æ¥çš„ã€‚
ç»„ä»¶â€œä¸è´Ÿè´£â€ç»´æŠ¤çŠ¶æ€ï¼ŒuseXXX å»ç®¡ç†äº†ã€‚

5æ˜Ÿè¯„æ˜Ÿç»„ä»¶ ä»ä¸­é—´å¾€ä¸¤è¾¹åˆ‡å‰²
```vue
<template>
    <div>
        {{rate}}
    </div>
</template>

<script setup>
import { defineProps,computed } from 'vue';
let props = defineProps({ // å®šä¹‰ç»„ä»¶æ¥å—å‚æ•°ï¼Œä½¿ç”¨æ–¹å¼æ˜¯props.xxxï¼Œè€Œä¸æ˜¯this.xxx
    value: Number
})
let rate = computed(()=>"â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†".slice(5 - props.value, 10 - props.value))
</script>
```

```vue
<template>
<div :style="fontstyle">
    <div class='rate' @mouseout="mouseOut">
      <span @mouseover="mouseOver(num)"  v-for='num in 5' :key="num">â˜†</span>
      <span class='hollow' :style="fontwidth">
        <span @mouseover="mouseOver(num)" v-for='num in 5' :key="num">â˜…</span>
      </span>
    </div> 
</div>
</template>
<script setup>
// ...å…¶ä»–ä»£ç 
// è¯„åˆ†å®½åº¦
let width = ref(props.value)
function mouseOver(i){
    width.value = i 
}
function mouseOut(){
    width.value = props.value
}
const fontwidth = computed(()=>`width:${width.value}em;`)

</script>

<style scoped>
.rate{
  position:relative;
  display: inline-block;
}
.rate > span.hollow {
  position:absolute;
  display: inline-block;
  top:0;
  left:0;
  width:0;
  overflow:hidden;
}
</style>
```


### æ‰‹å†™åœ¨vue3ä¸­çš„å“åº”å¼store
window._store å¹¶ä¸æ˜¯å“åº”å¼çš„ï¼Œå¦‚æœåœ¨ Vue é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±æ— æ³•è‡ªåŠ¨æ›´æ–°é¡µé¢
æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨ ref å’Œ reactive å»æŠŠæ•°æ®åŒ…è£¹æˆå“åº”å¼æ•°æ®
å¹¶ä¸”æä¾›ç»Ÿä¸€çš„æ“ä½œæ–¹æ³•ï¼Œè¿™å…¶å®å°±æ˜¯æ•°æ®ç®¡ç†æ¡†æ¶ Vuex çš„é›å½¢äº†


```js

import { inject, reactive } from 'vue'
const STORE_KEY = '__store__'
function useStore() {
  return inject(STORE_KEY)
}
function createStore(options) {
  return new Store(options)
}
class Store {
  constructor(options) {
    this.$options = options
    this._state = reactive({
      data: options.state()
    })
    this._mutations = options.mutations
  }
  get state() {
    return this._state.data
  }
  commit = (type, payload) => {
    const entry = this._mutations[type]
    entry && entry(this.state, payload)
  }
  install(app) {
    app.provide(STORE_KEY, this)
  }
}
export { createStore, useStore }
```

### æ‰‹å†™åœ¨vue3ä¸­çš„vue-router

myRouter.js
```js
import {ref,inject} from 'vue'
const ROUTER_KEY = '__router__'

function createRouter(options){
    return new Router(options)
}

function useRouter(){
    return inject(ROUTER_KEY)
}
function createWebHashHistory(){
    function bindEvents(fn){
        window.addEventListener('hashchange',fn)
    }
    return {
        bindEvents,
        url:window.location.hash.slice(1) || '/'
    }
}
class Router{
    constructor(options){
        this.history = options.history
        this.routes = options.routes
        this.current = ref(this.history.url)

        this.history.bindEvents(()=>{
            this.current.value = window.location.hash.slice(1)
        })
    }
    install(app){
        app.provide(ROUTER_KEY,this)
    }
}

export {createRouter,createWebHashHistory,useRouter}
```

main.js
```js
import {
    createRouter,
    createWebHashHistory,
} from './grouter/index'
const router = createRouter({
  history: createWebHashHistory(),
  routes // é¡µé¢ç»„ä»¶SFCç»„ä»¶åœ¨å¯¹è±¡æ•°æ®é‡Œ
})
```

### æ‰‹å†™router-viewç»„ä»¶

current è¿”å›å½“å‰çš„è·¯ç”±åœ°å€ï¼Œå¹¶ä¸”ä½¿ç”¨ ref åŒ…è£¹æˆå“åº”å¼çš„æ•°æ®ã€‚router-view ç»„ä»¶çš„åŠŸèƒ½ï¼Œå°±æ˜¯ current å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå»åŒ¹é… current åœ°å€å¯¹åº”çš„ç»„ä»¶ï¼Œç„¶ååŠ¨æ€æ¸²æŸ“åˆ° router-view å°±å¯ä»¥äº†
```vue
<template>
    <component :is="comp"></component>
</template>
<script setup>

import {computed } from 'vue'
import { useRouter } from '../myRouter/index'

let router = useRouter()

const comp = computed(()=>{
    const route = router.routes.find(
        (route) => route.path === router.current.value
    )
    return route?route.component : null
})
</script>
```

### æ‰‹å†™router-linkç»„ä»¶
æŠŠ a æ ‡ç­¾çš„ href å±æ€§å‰é¢åŠ äº†ä¸ªä¸€ä¸ª #ï¼Œ å°±å®ç°äº† hash çš„ä¿®æ”¹
```vue
<template>
    <a :href="'#'+props.to">
        <slot />
    </a>
</template>

<script setup>
import {defineProps} from 'vue'
let props = defineProps({
    to:{type:String,required:true}
})

</script>
```

å…¨å±€æŒ‚è½½ç»„ä»¶router-view router-link

```js
const app = createApp()
app.component("router-link",RouterLink)
app.component("router-view",RouterView)
```

å› ä¸ºè¿™ä¸ªä¸¤ä¸ªå…¨å±€ç»„ä»¶åªæœ‰æŒ‚è½½routeræ’ä»¶æ‰éœ€è¦
å› æ­¤å¯ä»¥æ”¾åœ¨routeræ’ä»¶çš„installé‡Œ
```js


import {ref,inject} from 'vue'
import RouterLink from './RouterLink.vue'
import RouterView from './RouterView.vue'
class Router{
    ....
    install(app){
        app.provide(ROUTER_KEY,this)
        app.component("router-link",RouterLink)
        app.component("router-view",RouterView)
    }
}
```

## vue3 tsé™åˆ¶

```ts
import { computed, reactive, ref } from '@vue/runtime-core';
interface typeObj {
  name:string,
  price:number
}

const msg = ref('') //  æ ¹æ®è¾“å…¥å‚æ•°æ¨å¯¼å­—ç¬¦ä¸²ç±»å‹
const msg1 = ref<string>('') //  å¯ä»¥é€šè¿‡èŒƒå‹æ˜¾ç¤ºçº¦æŸ

const obj = reactive({})
const course = reactive<typeObj>({name: 'ç©è½¬Vue3å…¨å®¶æ¡¶', price: 129})

const msg2 = computed(() => '') // é»˜è®¤å‚æ•°æ¨å¯¼
const course2 = computed<typeObj>(() => {
  return {name: 'ç©è½¬Vue3å…¨å®¶æ¡¶', price: 129}
})
```
ğŸ‘† `ref` `reactive` `computed` éƒ½å…·æœ‰ç±»å‹éšå¼æ¨å¯¼ï¼Œæ ¹æ®ä¼ å…¥å’Œreturn è‡ªåŠ¨æ¨å¯¼
å¹¶ä¸”éƒ½å¯ä»¥é€šè¿‡æ³›å‹(tsç”¨äºç±»å‹æ¨å¯¼çš„å˜é‡)è¦†ç›–éšå¼æ¨å¯¼ç»“æœï¼Œå³æ˜¾å¼çº¦æŸ

å¼€å‘è¿‡ç¨‹ä½¿ç”¨åˆ°çš„å“åº”å¼æ•°æ®ï¼Œå¯¹è±¡ç±»å‹æ•°æ®æœ€å¥½éƒ½åšå¥½æ³›å‹æŒ‡å®š(åŸºç¡€ç±»å‹é éšå¼æ¨å¯¼å³å¯
```ts
import {ref, Ref} from 'vue'

interface Todo{
  title: string,
  done: boolean
}

// å®šä¹‰å“åº”å¼å¯¹è±¡æ•°æ®
const item = reactive<Todo>({title: 'ç©è½¬Vue3å…¨å®¶æ¡¶', done: false})

// å®šä¹‰å“åº”å¼æ•°ç»„æ•°æ®
let todos:Ref<Todo[]> = ref([{title:'å­¦ä¹ Vue',done:false}])

// å®šä¹‰å“åº”å¼
```


## ç»„ä»¶å¼€å‘
ç»„ä»¶é™¤äº†è¦å¯¼å‡ºç»„ä»¶è‡ªèº«è¿˜è¦å¯¼å‡ºç±»å‹
åœ¨vueçš„æ—¶å€™æ˜¯ç›´æ¥å¼•ç”¨.vueæ–‡ä»¶ï¼Œè€Œ.vueæ–‡ä»¶çš„jséƒ¨åˆ†å°±æ˜¯ `export default`

åœ¨vue3ä¸­å¦‚æœä¸ä½¿ç”¨`setup script` è€Œæ˜¯ä½¿ç”¨ `setup function` çš„è¯ï¼Œè¿˜æ˜¯è¦ `export default defineComponent`

```ts
// å¯¼å‡ºç»„ä»¶
export default defineComponent({
  name: 'MyComponent',
  props: {
    list: {
      type: Array as PropType<MyComponentProps[]>,
      required: true
    }
  }
})

// å¯¼å‡ºç±»å‹å®šä¹‰(æ•°ç»„çš„å¯¹è±¡å±æ€§ç±»å‹
export interface MyComponentProps {
  id: string,
  title: string
}
```

ä½¿ç”¨æ–¹
```ts
// å¼•å…¥ç»„ä»¶åŠç±»å‹
import MyComponent {MyComponentProps} from './MyComponent.vue'

const list: MyComponentProps[] = [
  {id:'', title:''}
]
```